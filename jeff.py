my_dict = {
    ',': 1074,
    '.': 572,
    ':': 416,
    'message': 73,
    '@': 462,
    'Erica': 35,
    'enron.com': 64,
    'Murdock': 32,
    'Jerry': 27,
    'Mr.': 36,
    'Jeff': 147,
    'Skilling': 47,
    'Harris': 25,
    '<': 56,
    '>': 56,
    '--': 404,
    'information': 29,
    'If': 34,
    'error': 20,
    'dinners': 10,
    '?': 59,
    'The': 61,
    '(': 108,
    ')': 112,
    'PM': 57,
    'To': 88,
    "''": 69,
    'Jeff.Skilling': 22,
    'Subject': 75,
    'Telephone': 15,
    'Call': 15,
    'one': 14,
    'scheduled': 23,
    'Joannie': 26,
    'I': 188,
    'time': 31,
    'EHarris': 10,
    'insightpartners.com': 10,
    '05/14/2001': 12,
    "'": 27,
    'cc': 65,
    'best': 6,
    'call': 16,
    'brief': 6,
    'May': 34,
    'currently': 8,
    'July': 6,
    '19': 8,
    'next': 14,
    'Insight': 6,
    'Capital': 7,
    'dinner': 27,
    'purpose': 7,
    '_______________________________________________________': 8,
    'This': 11,
    'may': 13,
    'contain': 8,
    'confidential': 11,
    'and/or': 8,
    'legally': 8,
    'privileged': 8,
    'sent': 10,
    'please': 24,
    'reply': 9,
    'immediately': 9,
    'advise': 11,
    'sender': 8,
    'destroy': 8,
    'copies': 8,
    'printout': 8,
    'intended': 8,
    'recipient': 8,
    'unauthorized': 8,
    'dissemination': 8,
    'distribution': 8,
    'copying': 8,
    'material': 8,
    'attachments': 8,
    'strictly': 11,
    'forbidden': 8,
    'thanks': 7,
    'note': 4,
    'left': 1,
    'office': 5,
    'day': 2,
    'return': 3,
    'tomorrow': 10,
    'morning': 4,
    'In': 6,
    'meantime': 1,
    "'ll": 23,
    'run': 1,
    'see': 13,
    'thinks': 1,
    'makes': 2,
    'sense': 1,
    'Do': 8,
    'dates': 1,
    'future': 11,
    'mind': 12,
    'picture': 2,
    'address': 6,
    'Greetings': 1,
    'Tom': 2,
    'great': 11,
    'Jeffrey': 11,
    'Inauguration': 1,
    'asked': 9,
    'send': 6,
    'Unfortunately': 4,
    "n't": 17,
    'mailing': 1,
    'would': 45,
    'e-mail': 9,
    'get': 11,
    'right': 6,
    'Thanks': 38,
    'hope': 2,
    'well': 7,
    '!': 40,
    'SRS': 21,
    'vacation': 1,
    'Would': 4,
    'possible': 2,
    'schedule': 4,
    'quarter': 3,
    '12:09:54': 2,
    "'jeff.skilling": 3,
    'jeff.skilling': 9,
    'Dear': 5,
    'write': 2,
    'behalf': 3,
    'Europe': 4,
    'pass': 3,
    'following': 6,
    'regarding': 3,
    'telephone': 4,
    '10:00am': 2,
    'CST': 2,
    'Tuesday': 6,
    '15': 8,
    'hosts': 2,
    'quarterly': 2,
    'Robert': 6,
    'Rubin': 2,
    'Steve': 5,
    'Friedman': 2,
    'selected': 2,
    'guests': 3,
    'Our': 6,
    'held': 3,
    'Aspen': 2,
    'Colorado': 2,
    'Current': 2,
    'State': 2,
    'Global': 3,
    'Market': 2,
    'topics': 3,
    'discussion': 3,
    'Jack': 2,
    'Welch': 2,
    'GE': 2,
    'fellow': 4,
    'invitees': 6,
    'conversation': 6,
    'discuss': 3,
    'detail': 2,
    'fully': 1,
    'Please': 15,
    'hesitate': 2,
    'September': 3,
    'Regards': 12,
    'RE': 10,
    'Thank': 20,
    "'m": 12,
    '25': 11,
    'Sherri': 38,
    'Sera': 23,
    'Assistant': 6,
    '713.853.5984': 7,
    '713.646.8381': 7,
    'fax': 9,
    'sherri.sera': 9,
    "'Jeff.Skilling": 5,
    'list': 8,
    'event': 15,
    "'s": 54,
    '-Original': 10,
    'Message': 10,
    'Wednesday': 8,
    'tour': 5,
    '-': 85,
    'think': 3,
    'meet': 12,
    'lobby': 2,
    'Hobby': 4,
    'Performing': 3,
    'Arts': 3,
    'Center': 8,
    'Just': 5,
    'Good': 4,
    'Stan': 4,
    'holding': 1,
    '11:00': 1,
    'Noon': 1,
    'building': 3,
    'okay': 1,
    'Bill': 3,
    'Donovan': 1,
    'leaving': 1,
    'go': 5,
    'town': 3,
    'lunch': 4,
    'work': 12,
    'weekend': 3,
    'stanmarek': 4,
    'marekbros.com': 4,
    '05/04/2001': 3,
    '09:22:05': 1,
    'AM': 34,
    'Re': 16,
    'Follow-Up': 4,
    'Brent': 4,
    'Larsen': 4,
    'reminder': 1,
    'job': 2,
    'San': 6,
    'Diego': 6,
    'night': 1,
    'wanted': 11,
    'check': 1,
    'today': 8,
    'happy': 5,
    'come': 2,
    'pick': 5,
    'give': 4,
    'set': 3,
    'also': 17,
    'available': 5,
    'show': 1,
    '-Stan': 4,
    'Shyam': 3,
    'Enron': 109,
    'industry': 4,
    'appropriate': 3,
    'person': 2,
    'You': 10,
    'reach': 4,
    'Giridharadas': 2,
    'sgiridha': 2,
    'prismintl.com': 2,
    'Hope': 2,
    'assistance': 2,
    'could': 4,
    'interview': 4,
    'coping': 2,
    'challenges': 3,
    'perspective': 3,
    'Cindy': 1,
    'Olson': 1,
    'contact': 2,
    'within': 4,
    '713-853-7418': 1,
    'Williamson': 10,
    '713-345-7774': 6,
    '05/11/2001': 1,
    '08:59:12': 1,
    'Guidance': 1,
    'Hello': 1,
    'A': 24,
    'voice': 1,
    'past': 7,
    'gain': 1,
    'point': 1,
    'helping': 3,
    'client': 1,
    'understand': 2,
    'companies': 9,
    'US': 3,
    'Natural': 3,
    'Gas': 1,
    'Power': 1,
    'terms': 1,
    'developing': 1,
    'retaining': 1,
    '``': 24,
    'skills': 1,
    'So': 5,
    'someone': 1,
    'provide': 3,
    'external': 1,
    'players': 1,
    'internal': 1,
    'means': 1,
    'individual': 1,
    'fine': 1,
    'much': 10,
    'imposition': 1,
    'undertake': 1,
    'keep': 3,
    'short': 3,
    'email': 1,
    'cell': 3,
    'phone': 2,
    '240-603-6084': 1,
    'lot': 1,
    'P': 7,
    'ISC': 3,
    'number': 9,
    'help': 9,
    '03/15/2001': 2,
    'Randi': 2,
    'Howard': 2,
    'My': 4,
    'Number': 2,
    'Hotline': 1,
    '10:32': 1,
    'Sent': 13,
    'Skilling/Corp/Enron': 30,
    'ENRON': 100,
    'Your': 5,
    'P00500599': 1,
    'For': 4,
    'convenience': 1,
    'http': 3,
    '//isc.enron.com/site/': 1,
    'Site': 1,
    'Highlights': 1,
    'reset': 1,
    'password': 1,
    'find': 4,
    'HOTLINE': 1,
    'From': 19,
    '10:01': 1,
    'Hotline/Corp/Enron': 1,
    'Could': 3,
    'forward': 10,
    'unable': 8,
    'XMS': 2,
    'system': 2,
    'need': 11,
    'ASAP': 2,
    'test': 1,
    '*': 120,
    'Houston': 34,
    'Vaughan': 10,
    'Club': 16,
    'chairman': 7,
    'pm': 6,
    'HBS': 14,
    'School': 10,
    'Members': 10,
    '7': 10,
    'Future': 4,
    'Chairman': 5,
    '$': 37,
    '20': 11,
    'He': 19,
    'Breakfast': 6,
    'meets': 4,
    'ROCC': 4,
    '7:00': 6,
    'dottie': 8,
    'kerr-solutions.com': 9,
    'President': 4,
    'Harvard': 15,
    'Business': 13,
    '&': 17,
    '2001': 14,
    'Company': 15,
    'Financial': 3,
    'director': 3,
    'since': 4,
    'trustee': 3,
    'location': 5,
    'TBD': 3,
    'June': 13,
    'Dottie': 6,
    'Kerr': 6,
    'Eugene': 2,
    'Nelson': 2,
    'Scarborough': 2,
    'McCullough': 2,
    'downtown': 4,
    'p.m': 5,
    'Sustaining': 4,
    'No': 12,
    'charge': 2,
    'reservations': 5,
    'Guests': 4,
    'noon': 2,
    '4': 2,
    'community': 2,
    'years': 7,
    'many': 3,
    'Gene': 2,
    'Greater': 2,
    'Partnership': 2,
    'What': 4,
    'want': 10,
    '1970': 2,
    'whose': 2,
    'Investment': 2,
    'founding': 2,
    'Association': 2,
    'Chartered': 2,
    'Analysts': 3,
    'served': 2,
    'Vanderbilt': 2,
    'University': 5,
    'Reservations': 3,
    'using': 4,
    'events': 6,
    'Social': 2,
    '6:00': 2,
    '8:00': 2,
    'spouses': 2,
    'welcome': 2,
    'Name': 4,
    'Card': 4,
    'invitation': 4,
    'Macerich': 27,
    'David': 28,
    'macerich.com': 12,
    'W': 9,
    'Delainey': 10,
    'EES': 20,
    'Conferences': 9,
    'speak': 11,
    'change': 9,
    'Angela': 9,
    '04/27/2001': 9,
    'customer': 10,
    '04/30/2001': 6,
    'offices': 6,
    'management': 13,
    'relationship': 6,
    'like': 23,
    'Conference': 6,
    'conference': 6,
    'Let': 7,
    'know': 28,
    'Forwarded': 12,
    'Delainey/HOU/EES': 6,
    'conferences': 6,
    'Art': 6,
    'areas': 6,
    'highly': 7,
    'leadership': 6,
    'strategic': 7,
    'either': 8,
    'Executive': 8,
    '9': 7,
    'include': 6,
    'Team': 9,
    'people': 10,
    'agreed': 1,
    'participate': 1,
    '05:12': 3,
    'heading': 3,
    'team': 3,
    'At': 2,
    'meeting': 7,
    'discussing': 2,
    'outsource': 2,
    'direct': 3,
    'reports': 4,
    'cultural': 2,
    'characteristics': 2,
    'However': 3,
    'really': 4,
    'presentation': 14,
    'general': 1,
    'heard': 2,
    'believes': 1,
    'approach': 2,
    'benefit': 1,
    'Obviously': 1,
    'guys': 2,
    'important': 2,
    'Due': 2,
    'fact': 1,
    'attend': 7,
    'believe': 1,
    'better': 6,
    'reschedule': 1,
    'sometime': 1,
    ';': 139,
    '...': 9,
    'Loretta': 3,
    'goal': 25,
    'pledge': 10,
    'assistants': 2,
    'Rebecca': 6,
    'put': 3,
    'little': 4,
    'Greg': 16,
    'raise': 15,
    'definitely': 1,
    'directed': 2,
    'solicited': 1,
    'executive': 2,
    'bcc': 3,
    "'d": 5,
    'quick': 1,
    'turnaround': 1,
    'Brelsford/ENRON': 1,
    'enronXgate': 54,
    '04/19/2001': 2,
    '05:22': 1,
    'says': 2,
    '500': 2,
    'always': 2,
    'glad': 1,
    'made': 3,
    'contributions': 1,
    'taxes': 1,
    'finished': 3,
    'exercise': 1,
    'On': 3,
    'Behalf': 2,
    'Of': 2,
    'Thursday': 3,
    'April': 11,
    '5:18': 2,
    'Baxter': 2,
    'Cliff': 7,
    'Rick': 10,
    'Buy/HOU/ECT': 6,
    'Glisan': 3,
    'Ben': 7,
    'Kean': 2,
    'Steven': 7,
    'Sherrick': 2,
    'Philippe': 7,
    'Bibi/HOU/ECT': 6,
    'Brown': 4,
    'Michael': 10,
    'Cline': 2,
    'Wade': 5,
    'James': 10,
    'Hughes/ENRON_DEVELOPMENT': 4,
    'Kitchen': 2,
    'Louise': 4,
    'McDonald/ENRON_DEVELOPMENT': 3,
    'Piper': 2,
    'Sherriff': 2,
    'John': 12,
    'Whalley': 3,
    'Dietrich': 2,
    'Janet': 3,
    'Barsky': 2,
    'try': 2,
    'anyone': 5,
    'else': 5,
    'joannie.williamson': 1,
    'Jeff_Hines': 1,
    'hines.com': 1,
    '05/01/2001': 1,
    '11:26:22': 1,
    'Membership': 1,
    'question': 1,
    'Through': 1,
    'YPO': 6,
    'International': 1,
    'got': 3,
    'membership': 1,
    'inquiry': 1,
    'CEO': 3,
    'Agennix': 1,
    'company': 14,
    'apparently': 1,
    'used': 4,
    'Bio': 1,
    'involved': 5,
    'start': 2,
    'Renewable': 1,
    'Energy': 5,
    'Corp.': 1,
    'Solar': 1,
    'Any': 1,
    'input': 1,
    'us': 11,
    'guy': 3,
    'Jay': 5,
    "'ve": 5,
    'decided': 2,
    'take': 7,
    'opportunity': 7,
    'venture': 2,
    'capital': 2,
    'non-compete': 2,
    'anything': 3,
    'might': 3,
    'taken': 1,
    'pretty': 3,
    'laid': 1,
    'back': 5,
    'noncompete': 1,
    'overlap': 1,
    'Having': 1,
    'said': 2,
    'however': 3,
    'last': 6,
    'veto': 1,
    'something': 6,
    'luck': 3,
    'missed': 1,
    'Best': 1,
    'regards': 1,
    'Fitzgerald': 1,
    'ECT': 63,
    '05/09/2001': 3,
    '08:55': 1,
    'Resignation': 1,
    'Question': 1,
    'Jeff-': 1,
    'As': 7,
    'somewhat': 2,
    'reluctantly': 1,
    'resign': 1,
    'possibility': 1,
    'six': 1,
    'month': 2,
    'unpaid': 1,
    'unvested': 1,
    'sabbatical': 1,
    'Primarily': 1,
    'reasons': 1,
    'precedence': 1,
    'unwilling': 1,
    'pursue': 1,
    'option': 1,
    'disappointing': 1,
    'accept': 1,
    'twofold': 1,
    'First': 1,
    'thank': 4,
    'Samuel': 3,
    'Pak': 3,
    'MS150': 9,
    'Sam': 2,
    'A/A': 2,
    'Encounter': 2,
    'talk': 2,
    'look': 8,
    'LaGrange': 2,
    'late': 2,
    'Saturday': 1,
    'afternoon': 2,
    'ride': 8,
    'COMMUNICATIONS': 10,
    '04/18/2001': 1,
    '12:34:18': 1,
    'name': 4,
    'Analyst': 4,
    'program': 2,
    'riding': 2,
    'year': 1,
    'writing': 1,
    'article': 1,
    'hoping': 1,
    'maybe': 1,
    'chat': 1,
    'minutes': 5,
    'Bellville': 1,
    'La': 2,
    'Grange': 1,
    'OK': 4,
    'introduce': 2,
    'Much': 1,
    '======================================': 1,
    'Broadband': 2,
    'Services': 2,
    '713-345-4485': 1,
    '713-416-5946': 1,
    '713-646-5745': 1,
    'samuel_pak': 1,
    'enron.net': 1,
    'global': 12,
    'practices': 12,
    'survey': 14,
    'GLOBE': 9,
    'link': 9,
    'study': 6,
    'project': 9,
    'compare': 6,
    'knowledge': 7,
    'communication': 6,
    'networks': 6,
    'Network': 8,
    'Survey': 6,
    'click': 6,
    'Stanford': 3,
    'collaboration': 3,
    'management-consulting': 3,
    'firm': 3,
    'McKinsey': 3,
    'conducting': 3,
    'large': 3,
    'corporations': 3,
    'organization': 4,
    'participating': 3,
    'order': 3,
    'learn': 3,
    'activities': 5,
    'leading': 5,
    'firms': 3,
    'bring': 7,
    'true': 3,
    'benefits': 3,
    'marketplace': 3,
    'One': 3,
    'unique': 3,
    'features': 3,
    'seeks': 3,
    'assess': 3,
    'asking': 3,
    'employees': 3,
    'throughout': 3,
    'comment': 3,
    'actual': 4,
    'experience': 7,
    'obtain': 3,
    'real': 3,
    'accurate': 3,
    'surveying': 3,
    'directly': 3,
    'operations': 3,
    'ask': 4,
    'getting': 4,
    'participation': 3,
    'Initiative': 3,
    'completing': 3,
    'longer': 3,
    'responses': 3,
    'treated': 3,
    'solely': 3,
    'Stanford/McKinsey': 3,
    'researchers': 3,
    'evaluate': 3,
    'specific': 5,
    'structures': 3,
    'impact': 3,
    'houstontech.org': 3,
    '24': 3,
    'Administrator': 2,
    'Mentor': 2,
    'Mentors': 2,
    'Technology': 2,
    'travelling': 2,
    'Debbie': 2,
    'Long': 1,
    'dlong': 1,
    '05/16/2001': 3,
    '05:30:21': 1,
    '5.24.01': 1,
    'invite': 3,
    'selection': 1,
    'newest': 1,
    'After': 2,
    'introductions': 1,
    'allowed': 1,
    'network': 1,
    'mentor': 1,
    'connections': 1,
    'breakfast': 2,
    'Briar': 3,
    '2603': 1,
    'Timmons': 1,
    'a.m.': 7,
    '9:00': 1,
    'a.m': 2,
    'cost': 1,
    'cash': 1,
    'accepted': 1,
    'door': 1,
    'register': 1,
    'online': 1,
    '//www.houstontech.org/calendar/caldetail.asp': 1,
    'ID=118': 1,
    'DATE=5/24/2001': 1,
    'AGENDA': 1,
    '7:00-7:30': 1,
    'Registration': 1,
    '7:30-8:30': 1,
    'Breakfast/Introduction': 1,
    'Candidate': 2,
    'Companies': 1,
    '8:30-9:00': 1,
    'Wrap-up/Networking': 1,
    'turnout': 1,
    'pledges': 9,
    'collect': 2,
    'Stephanie': 5,
    'Stephane': 1,
    'sending': 1,
    'checks': 1,
    'totaling': 1,
    '22,063.73': 1,
    'represents': 1,
    '53': 1,
    '%': 2,
    '41,386.23': 1,
    'total': 1,
    'contacting': 1,
    'outstanding': 2,
    'care': 1,
    'package': 1,
    'daily': 1,
    'Strong/ENRON': 2,
    '05/15/2001': 2,
    '09:07': 2,
    'already': 2,
    'done': 4,
    'turn': 2,
    'TODAY': 2,
    'Strong': 2,
    'EB2365c': 2,
    'Becky': 2,
    'Pham': 2,
    'EB2336b': 2,
    'Amelia': 2,
    'Alder': 2,
    '3Ac3120': 2,
    'Morgan': 7,
    'Chapter': 3,
    'Ronnie': 3,
    'morgangroup.com': 2,
    'flattered': 2,
    'intrigued': 1,
    'offer': 2,
    'given': 2,
    'current': 1,
    'demands': 1,
    'must': 1,
    'respectfully': 1,
    'decline': 2,
    'let': 10,
    'interest': 5,
    'another': 3,
    'senior-level': 1,
    'representative': 1,
    'speaking': 1,
    'group': 2,
    'facilitate': 1,
    'Again': 1,
    'RonnieM': 1,
    '05/08/2001': 1,
    '02:33:06': 1,
    'S.': 1,
    'MichaelM': 1,
    'Invite': 2,
    'Hi': 3,
    'Mike': 3,
    'brother': 1,
    'living': 1,
    'member': 1,
    'With': 1,
    'propaganda': 1,
    'spread': 1,
    'electricity': 1,
    'energy': 6,
    'crisis': 1,
    'experiencing': 1,
    'California': 1,
    'thought': 4,
    'worthwhile': 1,
    'insider': 1,
    'view': 2,
    'expense': 6,
    'report': 9,
    '11/03/2000': 2,
    'attached': 6,
    'approved': 2,
    'payment': 2,
    '11:48': 1,
    'Katherine': 2,
    '11:33': 1,
    'Expense': 1,
    'Report': 1,
    'Attached': 1,
    'requires': 1,
    'approval': 1,
    'review': 1,
    'approve': 1,
    'UTILITIES': 3,
    'marcus': 3,
    'evans': 3,
    'Utilities': 2,
    'Felicia': 2,
    'Griffin': 2,
    'feliciag': 2,
    'marcusevanstx.com': 2,
    'SKILLING': 2,
    '.doc': 2,
    'Fact': 2,
    'Sheet.doc': 2,
    'Phone': 2,
    'prior': 1,
    'commitment': 1,
    '10:07:02': 1,
    'Invitation': 1,
    'Strategic': 1,
    'Summits': 1,
    'Chemicals': 1,
    'Office': 4,
    '713.650.6007': 1,
    'Home': 1,
    ':281-931-3009': 1,
    'Fax': 1,
    '713-759-1478': 1,
    'E-mail': 1,
    'URL': 1,
    '//www.marcusevans.com': 1,
    'employee': 1,
    'OUR': 1,
    'VISION': 1,
    'dedicated': 1,
    'partner': 1,
    'customers': 1,
    'understanding': 1,
    'delivering': 1,
    'premium': 2,
    'products': 1,
    'services': 2,
    'format': 5,
    'suited': 1,
    'access': 5,
    'Information': 2,
    'Excellence': 1,
    'Dr.': 2,
    'Bernard': 2,
    '04/24/2001': 2,
    '05:01:56': 1,
    'Recipient': 2,
    'suppressed': 2,
    'Luncheon': 1,
    'REMINDER': 1,
    'reservation': 1,
    'luncheon': 1,
    'hit': 1,
    'miss': 2,
    'exceptional': 1,
    'speaker': 1,
    'credentials': 1,
    'business': 3,
    'side': 1,
    'space': 1,
    'political': 1,
    'TOPIC': 1,
    'U.S.': 1,
    'Space': 1,
    'Program': 3,
    'Commercial': 1,
    'Political': 1,
    'Perspectives': 1,
    'SPEAKER': 1,
    'Jr.': 3,
    'Founder': 1,
    'Foundation': 1,
    'DATE': 1,
    'PLACE': 1,
    '811': 1,
    'Rusk': 1,
    'TIME': 1,
    '11:45': 1,
    'Check': 1,
    '11:55': 1,
    'Lunch': 1,
    '12:15': 1,
    'Presentation': 2,
    'Associate': 3,
    'rotation': 3,
    'AXIS': 2,
    'unit': 2,
    'news': 2,
    'members': 6,
    'eThink': 2,
    'We': 6,
    'THE': 3,
    'COUNTDOWN': 1,
    'IS': 1,
    'ON': 1,
    'Website': 1,
    'waiting': 1,
    'almost': 2,
    'ready': 2,
    'It': 9,
    'called': 1,
    'official': 1,
    'launch': 1,
    'date': 5,
    'Monday': 8,
    'January': 1,
    '31': 1,
    '2000': 3,
    'site': 1,
    'everything': 3,
    'user-friendly': 1,
    'Find': 1,
    'axis.enron.com': 1,
    'Associates': 1,
    'Available': 1,
    'data': 1,
    'pool': 1,
    'Online': 1,
    'resume': 2,
    'profile': 1,
    'repository': 1,
    'Knowledge': 1,
    'Important': 1,
    'forms': 1,
    'download': 1,
    'loan': 1,
    'applications': 1,
    'etc': 1,
    'Units': 1,
    'Search': 1,
    'talent': 1,
    'Manager': 1,
    'Toolbox': 1,
    'Peruse': 1,
    'qualifications': 1,
    'resumes': 1,
    'career': 4,
    'histories': 1,
    'Create': 1,
    'requests': 1,
    'Learn': 1,
    'Participate': 1,
    'everyone': 3,
    'utilize': 1,
    'website': 1,
    'designed': 1,
    'groups': 1,
    'regard': 1,
    'Professor': 6,
    'Garvin': 6,
    'European': 6,
    'PLEASE': 2,
    'PLAN': 2,
    'TO': 2,
    'ATTEND': 2,
    'NEW': 2,
    'BUSINESS': 2,
    'CREATION': 2,
    'August': 6,
    '8th': 2,
    '11:30-1:30': 2,
    'Board': 2,
    'Room': 2,
    'EB50': 2,
    'Presented': 2,
    'A.': 5,
    'making': 6,
    'part': 3,
    'five-year': 2,
    'research': 2,
    'partnership': 2,
    'entitled': 2,
    "'Modern": 2,
    'Giants': 2,
    'recently': 2,
    'delivered': 2,
    'Stanley': 5,
    'Strategy': 2,
    'Seminar': 2,
    'included': 2,
    '50': 2,
    'CEOs': 2,
    'presented': 2,
    'advanced': 2,
    'seminar': 2,
    'Parts': 2,
    'use': 3,
    'example': 2,
    'Rsvp': 2,
    'Aug': 2,
    '6th': 2,
    'Resume': 2,
    'Christie': 7,
    'Patrick': 5,
    '3-6117': 2,
    'Feel': 2,
    'free': 2,
    'drinks': 2,
    'provided': 2,
    'Communications': 21,
    '50,000': 4,
    'Mark': 21,
    'S': 5,
    '....': 2,
    'pre': 2,
    'match': 2,
    'pre-match': 1,
    'guess': 1,
    'ultimate': 1,
    '100,000': 1,
    'Like': 1,
    'poor': 1,
    'enough': 3,
    'pressure': 1,
    'generous': 1,
    'Muller': 2,
    '04/20/2001': 7,
    '08:14': 1,
    'even': 2,
    'though': 1,
    '9th': 1,
    'austin': 1,
    '.....': 1,
    'attempting': 1,
    'big': 2,
    'bucks': 1,
    'Big': 1,
    'Cheese': 1,
    '..': 1,
    '05:18': 4,
    'Baxter/HOU/ECT': 4,
    'Glisan/HOU/ECT': 4,
    'J': 6,
    'Kean/NA/Enron': 5,
    'Sherrick/Corp/Enron': 4,
    'Brown/NA/Enron': 3,
    'Cline/ENRON_DEVELOPMENT': 3,
    'ENRON_DEVELOPMENT': 22,
    'Kevin': 31,
    'kevinscott': 3,
    'onlinemailbox.net': 3,
    'Scott': 4,
    'new': 6,
    'Confirming': 1,
    '1:00': 1,
    'p.m.': 3,
    '12': 1,
    'Venetian': 1,
    'Resort': 1,
    'Las': 1,
    'Vegas': 1,
    '04/25/2001': 1,
    '04:46:18': 1,
    'respond': 1,
    'setting': 1,
    'aside': 1,
    'providing': 1,
    'advisory': 1,
    '1995': 1,
    'During': 1,
    'proud': 1,
    'service': 1,
    'rendered': 1,
    'independent': 1,
    'consultant': 1,
    'Now': 1,
    'feel': 1,
    'move': 1,
    'chapter': 1,
    'sitting': 1,
    'ways': 1,
    'apply': 1,
    'intellect': 1,
    'energies': 1,
    'professional': 1,
    'respect': 1,
    'tremendously': 1,
    'wherever': 1,
    'Rod': 4,
    'Hayslett/ENRON': 1,
    '06:52': 1,
    '100': 1,
    'Scrimshaw': 1,
    'Matthew': 2,
    'Cox': 1,
    'Hannon': 7,
    'Hayslett': 1,
    'Horton': 1,
    'McCarty': 2,
    'Danny': 2,
    'incredibly': 3,
    'busy': 3,
    'sure': 4,
    'simply': 3,
    'slipped': 3,
    'Well': 2,
    '[': 3,
    'mailto': 2,
    ']': 2,
    'visited': 1,
    'Ivory': 1,
    'Coast': 1,
    'Togo': 1,
    'Nigeria': 1,
    'Tanzania': 1,
    'twice': 1,
    'Kenya': 1,
    'Africa': 1,
    'three': 1,
    'times': 1,
    'love': 2,
    'place': 1,
    'spending': 1,
    'lots': 1,
    'sharing': 1,
    'photos': 1,
    'Fernando': 3,
    '01': 2,
    '12:17': 1,
    'Fernandez': 1,
    'E-Mail': 1,
    'receive': 2,
    'e-mails': 2,
    'assure': 2,
    'concerns': 2,
    'dealt': 2,
    'make': 5,
    'North': 6,
    'Shepherd': 5,
    'facility': 6,
    'panel': 7,
    '2:00': 4,
    'problem': 1,
    'panelists': 1,
    'arriving': 1,
    'cancelled': 1,
    'touch': 2,
    'base': 1,
    'thing': 1,
    'attaching': 1,
    'map': 1,
    '10': 2,
    'outside': 1,
    'arrangements': 2,
    'sedan': 6,
    'begins': 1,
    'buffet': 1,
    '7:30': 1,
    'begin': 1,
    '8:45': 1,
    'Arnoff': 1,
    'Thornton': 1,
    'around': 1,
    '8:15': 3,
    'cover': 1,
    'minute': 1,
    'items': 1,
    'beginning': 1,
    'CDT': 1,
    '713.854.1426': 1,
    'questions': 3,
    'additional': 1,
    'Ali': 3,
    'ago': 2,
    'biggest': 1,
    'portion': 1,
    '04/12/2001': 1,
    '11:05:55': 1,
    'Happy': 1,
    'Easter': 1,
    'met': 2,
    'Venezuela': 1,
    'kept': 1,
    'together': 1,
    'days': 1,
    'interested': 3,
    'Rodgrigues': 1,
    'sometimes': 1,
    'buddy': 1,
    'friends': 1,
    'extend': 1,
    'agenda': 1,
    'Those': 1,
    'hard': 1,
    'read': 1,
    'Otherwise': 1,
    'forget': 1,
    'Keep': 2,
    'stock': 1,
    'going': 2,
    'Turkish': 7,
    'GAMA': 6,
    'Trakya': 5,
    'investigation': 4,
    'sector': 4,
    'bureaucrats': 4,
    '01/31/2001': 3,
    'Joe': 8,
    'military': 3,
    'newspaper': 3,
    'reported': 3,
    'power': 3,
    'Yardim': 3,
    'BOTA': 3,
    'Rob': 2,
    'Dilg': 2,
    'INVESTIGATION': 2,
    'OF': 2,
    'CORRUPTION': 2,
    'IN': 2,
    'TURKISH': 2,
    'ENERGY': 2,
    'SECTOR': 2,
    'PRIVATE': 2,
    'CONFIDENTIAL': 2,
    'Eric': 2,
    'custody': 2,
    'monopoly': 2,
    'Resources': 2,
    'executives': 2,
    'target': 2,
    'wife': 2,
    'gas': 3,
    'car': 3,
    'gift': 2,
    'long': 2,
    'term': 2,
    '05:19': 1,
    'Derrick': 2,
    '03:52': 1,
    'Sherriff/LON/ECT': 2,
    'Walls/NA/Enron': 1,
    'jdilg': 1,
    'velaw.com': 1,
    'Vinson': 1,
    'Elkins': 1,
    'investigations': 1,
    'relating': 1,
    'potential': 1,
    'FCPA': 1,
    'issues': 1,
    'Walls': 1,
    'matter': 3,
    'Jim': 3,
    'rice.edu': 12,
    'Box': 3,
    'Field': 3,
    'EnronXGate': 7,
    'Rice': 3,
    'ALP': 2,
    'via': 2,
    "'re": 2,
    'tell': 3,
    'function': 1,
    'returning': 1,
    '10:00': 1,
    'mgillis': 1,
    'grwhit': 1,
    'lounghrid': 1,
    'cmiller': 1,
    'darrett': 1,
    'uecker': 1,
    'ghoshr': 1,
    'ghosei': 1,
    'luigical': 1,
    'pravas': 1,
    'igbal': 1,
    'Billy': 1,
    'Lemmons/Enron': 1,
    'Traci': 1,
    'Warner/ENRON': 1,
    'kean': 1,
    'Vince': 1,
    'Kaminski/HOU/ECT': 1,
    'Kenneth': 1,
    'Parkhill/NA/Enron': 1,
    'Alhamd': 1,
    'Alkhayat/Enron': 1,
    'Final': 1,
    'Post': 2,
    'Celebration': 1,
    'Friends': 1,
    'Rice-ALP': 1,
    'final': 1,
    'MONDAY': 1,
    '7th': 2,
    '4pm': 1,
    '1400': 1,
    'Smith': 1,
    'Lobby': 2,
    'assistant': 1,
    'Melinda': 1,
    'cordially': 1,
    'invited': 1,
    'Astro': 1,
    'game': 1,
    'vs': 1,
    'Phillies': 1,
    'running': 1,
    '700,000': 1,
    'personal': 1,
    'half': 2,
    'way': 6,
    'Wo': 1,
    'consider': 1,
    'consideration': 1,
    'hearing': 2,
    'collected': 2,
    'yet': 1,
    '65': 1,
    'shall': 1,
    'wait': 1,
    'slackers': 1,
    'unfortunately': 1,
    'wo': 1,
    'able': 3,
    '11:21:54': 1,
    'Friday': 3,
    'afterwards': 1,
    'Paul': 3,
    'join': 3,
    'in-room': 1,
    'Embedded': 8,
    'StdOleLink': 8,
    'Hannon/Enron': 6,
    'Ok': 2,
    'told': 2,
    'received': 3,
    'range': 2,
    '6000': 2,
    'heart': 2,
    'keeping': 2,
    'pocketbook': 2,
    'By': 2,
    '14': 2,
    'hours': 2,
    '01:56:56': 2,
    'never': 2,
    '04/20/01': 2,
    '10:45': 2,
    'How': 3,
    '08:03:14': 3,
    '04/19/01': 3,
    'joined': 1,
    'congratulations': 1,
    'Look': 1,
    'seeing': 1,
    'Tully': 1,
    'Stadium': 1,
    '20th': 1,
    'Matt': 2,
    'Khourie': 2,
    'Gentlemen': 1,
    'Messrs.': 1,
    'Micheal': 1,
    'Holthouse': 1,
    'co-hosts': 1,
    'evening': 3,
    '23': 4,
    'Grille': 1,
    'located': 3,
    '5365': 1,
    'Westheimer': 1,
    'Road': 1,
    'Galleria': 2,
    'area': 1,
    'Should': 1,
    'transportation': 1,
    'restaurant': 1,
    'confirming': 1,
    'attendance': 1,
    'trust': 5,
    'Ken': 2,
    'Don': 2,
    'Fizer': 2,
    'stuff': 2,
    'easy': 2,
    'financial': 3,
    'found': 2,
    'couple': 2,
    'went': 2,
    'Kirby': 2,
    'investments': 2,
    'home': 2,
    'week': 2,
    'perhaps': 1,
    'retrieved': 1,
    'house': 1,
    'cleaning': 1,
    'files': 1,
    'Mon': 1,
    '8/20/2001': 1,
    '10:20': 1,
    'Cc': 1,
    'Jeff/Mark': 1,
    'whoever': 1,
    'gets': 1,
    'emails': 1,
    'Astros': 1,
    'tickets': 1,
    'estate': 1,
    'planning': 1,
    'lawyer': 1,
    'Beck': 2,
    '1360': 1,
    'Oak': 1,
    'Blvd': 1,
    'Suite': 1,
    '1600': 1,
    'TX': 1,
    '77056': 1,
    '713-332-4251': 1,
    'clueless': 1,
    'explain': 1,
    'recommend': 1,
    'first': 2,
    'stop': 1,
    '01/12/2001': 2,
    '12:58': 1,
    'Janice': 1,
    'Avery': 1,
    '11:51': 1,
    'Beard': 1,
    'Vote': 1,
    'definite': 1,
    'yes': 8,
    'beard': 1,
    'appear': 1,
    'cooler': 1,
    'appealing': 1,
    'jan': 1,
    'Dave': 4,
    'filling': 1,
    'quickly': 1,
    'flexible': 1,
    'probably': 2,
    'R': 4,
    'Tim': 2,
    'Bob': 4,
    'Jennifer': 2,
    'Daniel': 2,
    'EUEnronXgate': 2,
    'EnronOnline': 2,
    'Summary': 2,
    'Simon': 1,
    'open': 1,
    'document': 1,
    'resend': 1,
    'Simone': 1,
    'rose/ENRON': 1,
    '04:52': 1,
    'Sunil': 1,
    'Abraham/ENRON': 1,
    'Baxter/ENRON': 1,
    'Sally': 2,
    'Beck/ENRON': 1,
    'Belden/ENRON': 1,
    'Bibi/ENRON': 1,
    'Raymond': 1,
    'Bowen/ENRON': 1,
    'Brackett/ENRON': 1,
    'William': 3,
    'Bradford/ENRON': 1,
    'Bridges/ENRON': 1,
    'Brown/LON/ECT': 1,
    'Lydia': 1,
    'Cannon/ENRON': 1,
    'Crane/ENRON': 1,
    'Cummings/ENRON': 1,
    'Bryan': 1,
    'Deluca/ENRON': 1,
    'Karen': 2,
    'Denne/Corp/Enron': 1,
    'deBoisblanc': 1,
    'Denny/ENRON': 1,
    'Diamond/ENRON': 1,
    'Marc': 1,
    'Eichmann/ENRON': 1,
    'Fallon/Enron': 1,
    'Fitzgerald/NY/ECT': 1,
    'Forster/ENRON': 1,
    'Frevert/ENRON': 1,
    'Bruce': 1,
    'Garner/LON/ECT': 1,
    'Goddard/EU/Enron': 1,
    'Gold/LON/ECT': 1,
    'Amita': 1,
    'Gosalia/LON/ECT': 1,
    'E': 1,
    'Haedicke/HOU/ECT': 1,
    'Harbert/ENRON': 1,
    'Hermans/ENRON': 1,
    'Kimberly': 1,
    'Hillis/ENRON': 1,
    'Joseph': 3,
    'Hirl/AP/ENRON': 1,
    '03/02/2001': 2,
    'E.ON': 3,
    '09:37': 1,
    'Gold': 2,
    '09:58': 1,
    'Discussions': 1,
    'wondering': 1,
    'came': 1,
    'Harig': 1,
    'particular': 1,
    'explore': 1,
    'metals': 1,
    'concept': 1,
    'aol.com': 3,
    'aware': 2,
    'traveling': 1,
    'remainder': 1,
    'Mbkuntz': 1,
    '05:04:47': 1,
    'judyaspen': 1,
    'Judy': 1,
    'Lay': 1,
    'Allen': 2,
    'associate': 1,
    'Federal': 1,
    'Reserve': 1,
    'board': 1,
    'spoke': 1,
    'desire': 1,
    'graduate': 1,
    'Princeton': 1,
    'two': 1,
    'modeling': 1,
    'communications': 1,
    'Towards': 1,
    'assessing': 1,
    'skill': 1,
    'relative': 1,
    'peers': 1,
    'took': 1,
    '740': 1,
    'GMAT': 1,
    'interned': 1,
    'exploration': 1,
    'familiar': 1,
    'likewise': 1,
    'worked': 1,
    'clients': 1,
    'telecommunications': 1,
    'bandwidth': 1,
    'trading/pooling': 1,
    'field': 1,
    'training/business': 1,
    'analyst': 1,
    'programs': 1,
    'exploring': 1,
    'opportunities': 1,
    'therein': 1,
    'notice': 1,
    'grateful': 1,
    'Beal': 2,
    'reserved': 1,
    '7:15a': 1,
    'Four': 3,
    'Seasons': 3,
    'stand': 2,
    'leave': 1,
    'Forum': 5,
    'topic': 4,
    'Grizzle': 2,
    'Danguole': 2,
    'Spakevicius': 2,
    'club': 2,
    'ever': 2,
    'character': 2,
    '05/12/2001': 1,
    '05:17:57': 1,
    '05/18/01': 1,
    'Second': 1,
    'There': 1,
    'spaces': 1,
    'upcoming': 1,
    "Don't": 1,
    'exciting': 1,
    'Make': 1,
    'See': 1,
    'details': 1,
    'Raising': 1,
    'Children': 1,
    'Character': 1,
    'World': 1,
    'Affluence': 1,
    'Dinner': 3,
    'Discussion': 1,
    'Join': 1,
    'type': 3,
    'Ever': 1,
    'substantively': 1,
    'afraid': 1,
    'distance': 1,
    'solution': 1,
    'Modeled': 1,
    'Anne': 1,
    'Luminant': 6,
    'Gil': 3,
    'Quackenbush': 2,
    'Marmol': 2,
    'appreciates': 1,
    'due': 1,
    'heavy': 1,
    'travel': 1,
    'difficult': 1,
    'turned': 1,
    'several': 1,
    'invitations': 1,
    'boards': 1,
    'ca': 1,
    'commit': 1,
    'calls': 1,
    'nice': 1,
    'talking': 1,
    'Glad': 1,
    'hear': 1,
    'Yours': 1,
    'faithfully': 1,
    'gmarmol': 1,
    'gmarmol.com': 1,
    '03:27:50': 1,
    'Great': 1,
    'Congratulations': 1,
    '-belated-': 1,
    'ship': 1,
    'blowout': 1,
    'recent': 1,
    'piece': 1,
    'Bloomberg': 1,
    'Since': 1,
    'impactful': 1,
    'Networks': 1,
    'Sourcing': 1,
    'among': 1,
    'others': 1,
    'Oasis': 1,
    'heres': 1,
    'version': 1,
    'PRC': 1,
    'memo': 1,
    'hsb.edu': 4,
    'Frank': 2,
    'J.': 2,
    'George': 2,
    'Brian': 4,
    '8': 1,
    '2:26': 1,
    'Phillip': 1,
    'K.': 1,
    'Bay': 1,
    'Berberian': 1,
    'Bergsieker': 1,
    'Blachman': 1,
    'Jeremy': 1,
    "'kathleen.blakenship": 1,
    'Butts': 1,
    'Buy': 1,
    'Carter': 1,
    "'richard.cause4y": 1,
    'Colwell': 1,
    'Wes': 1,
    'Cordes': 1,
    'Cumberland': 1,
    'Shawn': 1,
    'Deffner': 1,
    'Detmering': 1,
    'Timothy': 1,
    'Dimichele': 1,
    'Rich': 1,
    'Dodson': 1,
    'Keith': 1,
    'Donahue': 1,
    'w.david.curan': 1,
    'Earle': 1,
    'Fallon': 1,
    'Fastow': 1,
    'Andrew': 1,
    'Frevert': 1,
    'Gahn': 1,
    "'kevin.garlandd": 1,
    'Haedicke': 1,
    'Briarwood': 1,
    'Court': 1,
    'Texas': 1,
    '77019': 1,
    '713-621-8620': 1,
    'TOMSKILLJR': 1,
    '11:40:03': 1,
    'jskilli': 1,
    'markskilling': 1,
    'hotmail.com': 1,
    'Washington': 1,
    'Pictures': 1,
    'pictures': 1,
    'boys': 1,
    'arrived': 1,
    'wonderful': 1,
    'convince': 1,
    'Love': 1,
    'DAD': 1,
    'table': 2,
    'Compton': 2,
    '713.731.9233': 1,
    'Once': 1,
    'inside': 1,
    'check-in': 1,
    'ladies': 1,
    'manning': 1,
    'tke': 1,
    'airport': 1,
    'destination': 1,
    'end': 1,
    '9:30': 1,
    '9:45': 1,
    'KCompton': 1,
    'kpcb.com': 1,
    '04/23/2001': 2,
    '09:51:29': 1,
    'HUGE': 1,
    '1300': 1,
    'Lamar': 1,
    'Street': 1,
    '7:15': 1,
    'otherwise': 1,
    'cab': 1,
    'Where': 1,
    '02/01/2000': 2,
    'process': 1,
    '04:17': 1,
    '03:54': 1,
    '03/06/2001': 2,
    'shareholders': 2,
    'sales': 2,
    '03:34': 1,
    '04:25': 1,
    'Voice': 1,
    'Mail': 1,
    'saved': 1,
    'quite': 1,
    'bit': 1,
    'money': 1,
    'looks': 1,
    'City': 3,
    'London': 1,
    'duped': 1,
    'fool': 1,
    'wonder': 1,
    'actually': 1,
    'auctions': 1,
    'versus': 1,
    'pre-arranged': 1,
    'dressed': 1,
    'brainstorming': 1,
    'sessions': 1,
    'rule': 1,
    'Germans': 1,
    '10:33:09': 1,
    'Put': 1,
    '750': 1,
    '04/23/01': 1,
    '09:33': 1,
    'Park': 3,
    'Wyoming': 2,
    'disregard': 1,
    'previous': 1,
    'unless': 1,
    '4-7': 1,
    'UT': 1,
    'attending': 1,
    'seen': 1,
    'responded': 1,
    'hardhats': 2,
    '10:14:48': 1,
    '11': 1,
    'Will': 1,
    'Outlook': 4,
    'Migration': 3,
    'Notes': 3,
    'migration': 3,
    'Yes': 3,
    'Alan': 2,
    'L': 2,
    'B': 2,
    'Veronica': 2,
    'Mary': 2,
    'Desktop': 2,
    'Palm': 2,
    'Pilot': 2,
    'permission': 2,
    'Email/Calendar': 2,
    'responsible': 2,
    'updating': 2,
    'book': 2,
    'shared': 2,
    'calendar': 2,
    'MM/DD/YY': 2,
    '01:02': 1,
    'Elena': 1,
    'Chilkina/Enron': 1,
    'Jose': 1,
    'Marquez/Enron': 1,
    'G': 1,
    'Moore/Enron': 1,
    'Roberts/Enron': 1,
    'Tony': 1,
    'Hamilton/EU/Enron': 1,
    'Smith/Enron': 1,
    'McGaughy/Corp/Enron': 1,
    'Dorothy': 1,
    'Burrell/GPGFIN/Enron': 1,
    'Posway/GPGFIN/Enron': 1,
    'Maritta': 1,
    'Mullet/GPGFIN/Enron': 1,
    'Mitcham/GPGFIN/Enron': 1,
    'Swinford/NA/Enron': 1,
    'Jones/GasPlant/TS/ECT': 1,
    'Brandt/NA/Enron': 1,
    'Charles': 1,
    'Upshaw/EPSC/HOU/ECT': 1,
    'Harvey': 1,
    'Mitchell/ENRON_DEVELOPMENT': 1,
    'Henry': 1,
    'Terech/EPSC/HOU/ECT': 1,
    'Thomas/NA/Enron': 1,
    'Kitchen/HOU/ECT': 1,
    'Piper/Corp/Enron': 1,
    'Whalley/HOU/ECT': 1,
    'Dietrich/HOU/EES': 1,
    'Muller/HOU/EES': 1,
    'Scrimshaw/LON/ECT': 1,
    'Cox/Enron': 1,
    'Hayslett/FGT/Enron': 1,
    'Horton/Houston/Eott': 1,
    'Eott': 1,
    'McCarty/ET': 1,
    'S/Enron': 1
}
import json
import os
import glob
import csv
import time
import nltk
import pandas as pd
from nltk.tokenize import word_tokenize
from nltk.corpus import stopwords
nltk.download('punkt')
from nltk.sentiment import SentimentIntensityAnalyzer
nltk.download('vader_lexicon')

# arr1 = ["special", "purpose", "entity", "chewco", "whitewing", "ljm", "ljm1", "ljm2", "raptor", "transfer", "offshore", "losses"]
# arr2 = ["accounting", "fix", "adjustment", "conceal", "hide", "cover", "up", "trouble"]
# arr3 = ["shit", "fuck", "destroy", "upset", "angry", "idiot", "wtf", "fire"]

# # new = dict(sorted(my_dict.items(), key=lambda item: item[1], reverse=True))
# # # print(new)

# # for x in my_dict.keys():
# #     if (x.lower() in arr1) or (x.lower() in arr2) or (x.lower() in arr3):
# #         print(x)
# path = 'C:/Users/Mohammed Hager/Documents/Python_Analytics/dataset'

# counter = 0
# for filename in glob.glob(os.path.join(path, '*.json')):    
#     with open(filename, encoding='utf-8', mode='r') as currentFile:
#         print(counter)
#         counter+=1
#         data=currentFile.read().replace('/n', '')
#         json_data = json.loads(data)
#         words= word_tokenize(json_data["text"])
#         useful_words = [word  for word in words if word not in stopwords.words('English')]
#         frequency = nltk.FreqDist(useful_words)
#         print(frequency.most_common)
#         if json_data["headers"]["from"] == "jeff.skilling@enron.com":
#             words= word_tokenize(json_data["text"])
#             useful_words = [word  for word in words if word not in stopwords.words('English')]
#             frequency = nltk.FreqDist(useful_words)
#             print(frequency)
#             # if "destroy" in frequency

129


import csv
from collections import defaultdict

columns = defaultdict(list) # each value in each column is appended to a list

with open('keyword_combine.csv') as f:
    reader = csv.DictReader(f) # read rows into a dictionary format
    for row in reader: # read a row as {column1: value1, column2: value2,...}
        for (k,v) in row.items(): # go over each column name and value 
            columns[k].append(v) # append the value into the appropriate list
                                 # based on column name k

print(len(columns['email']))
email_arr = columns['email']
email_arrv2 = []
for email in email_arr:
    if "@enron.com" in email:
        email_arrv2.append(email)

indiviualKeyword_dict = {}
def individualKeywords(frequency, name):
    if name in indiviualKeyword_dict:
        for index in frequency.most_common(100):
            if index[0] in indiviualKeyword_dict[name]:
                indiviualKeyword_dict[name][index[0]] += index[1]
            else:
                indiviualKeyword_dict[name][index[0]] = index[1]
    else:
        indiviualKeyword_dict[name] = {}
        for index in frequency.most_common(100):
            if index[0] in indiviualKeyword_dict[name]:
                indiviualKeyword_dict[name][index[0]] += index[1]
            else:
                indiviualKeyword_dict[name][index[0]] = index[1]

path = 'C:/Users/Mohammed Hager/Documents/Python_Analytics/dataset'
for filename in glob.glob(os.path.join(path, '*.json')): 
    with open(filename, encoding='utf-8', mode='r') as currentFile:
        data=currentFile.read().replace('/n', '')
        json_data = json.loads(data)
        if json_data["headers"]["from"] in email_arrv2:
            words= word_tokenize(json_data["text"])
            useful_words = [word  for word in words if word not in stopwords.words('English')]
            frequency = nltk.FreqDist(useful_words)
            name = json_data["headers"]["from"]
            individualKeywords(frequency, name)

print("done with master list")
for element in indiviualKeyword_dict:
    temp = dict(sorted(indiviualKeyword_dict[element].items(), key=lambda item: item[1], reverse=True))
    indiviualKeyword_dict[element] = temp
print("done with dictionary")

with open('keywords_flagged_emails.json', 'a', newline='') as f:
    json.dump(indiviualKeyword_dict, f)

